# Docker compose for running from source
services:
  worker:
    image: ${QGIS_IMAGE}
    working_dir: /src/python_modules/py-qgis-processes
    command: ${SRCDIR}/tests/run-worker.sh
    volumes:
    - { type: bind, source: "../../../", target: /src }
    - { type: bind, source: "./.local", target: /.local }
    user: "${USER_ID}:${GROUP_ID}"
    environment:
      CONF_WORKER__BROKER_HOST: rabbitmq
      CONF_WORKER__BACKEND_HOST: redis:6379/0
    depends_on: [rabbitmq, redis]
  rabbitmq:
    image: rabbitmq:3
  redis:
    image: redis:6-alpine
